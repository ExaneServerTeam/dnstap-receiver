{
    "swagger": "2.0",
    "info": {
        "description": "This is a swagger for the API of the dnstap receiver.",
        "version": "2.2.0",
        "title": "Swagger for dnstap receiver",
        "contact": {
          "email": "d.machard@gmail.com"
        },
        "license": {
          "name": "MIT",
          "url": "https://github.com/dmachard/dnstap-receiver/blob/master/LICENSE"
        }
    },
    "host": "localhost",
    "basePath": "/",
    "schemes": [
        "http"
    ],
    "tags": [
        {
          "name": "stream",
          "description": "dnstap identity"
        },
        {
          "name": "counter",
          "description": "total number of"
        },
        {
          "name": "table",
          "description": "list of items sortered"
        }
    ],
    "paths": {
        "/streams": {
            "get": {
                "tags": [
                  "stream"
                ],
                "summary": "Get streams by identity",
                "description": "Get a list of all streams by identity received by the dnstap receiver",
                "operationId": "getStreams",
                "produces": [
                  "application/json"
                ],
                "parameters": [
                ],
                "responses": {
                  "200": {
                    "description": "success",
                    "schema": {
                      "type": "array",
                      "items": {
                        "$ref": "#/definitions/Stream"
                      }
                    }
                  }
            },
            "security": [
              {
                "api_key": []
              }
            ]
          }  
        },
        "/counters": {
            "get": {
                "tags": [
                  "counter"
                ],
                "summary": "Get counters",
                "description": "Get counters like number of clients, domains, queries, etc...",
                "operationId": "getCounters",
                "produces": [
                  "application/json"
                ],
                "parameters": [
                      {
                        "name": "more",
                        "in": "path",
                        "description": "additional counters to return",
                        "required": false,
                        "type": "string"
                      }
                ],
                "responses": {
                  "200": {
                    "description": "success",
                     "schema": {
                          "$ref": "#/definitions/CountersResponse"
                     }
                  }
                }
            },
            "security": [
              {
                "api_key": []
              }
            ]
        },
        "/tables": {
            "get": {
                "tags": [
                  "table"
                ],
                "summary": "Get tables",
                "description": "Get tables like top domains, clients, etc...",
                "operationId": "getTables",
                "produces": [
                  "application/json"
                ],
                "parameters": [
                  {
                    "name": "more",
                    "in": "path",
                    "description": "additional tables to return",
                    "required": false,
                    "type": "string"
                  }
                ],
                "responses": {
                  "200": {
                    "description": "success",
                     "schema": {
                          "$ref": "#/definitions/TablesResponse"
                        }
                  }
                }
            },
            "security": [
              {
                "api_key": []
              }
            ]
        },
        "/reset": {
            "delete": {
                "tags": [
                  "table"
                ],
                "summary": "Reset counters and tables",
                "description": "",
                "operationId": "resetStatistics",
                "produces": [
                  "application/json"
                ],
                "parameters": [
                ]
            },
            "security": [
              {
                "api_key": []
              }
            ]
        }
    },
    "securityDefinitions": {
        "api_key": {
          "type": "apiKey",
          "name": "x-api-key",
          "in": "header"
        }
    },
    "definitions": {
        "TablesResponse": {
          "type": "object",
          "properties": {
            "stream": {
              "type": "string"
            },
            "top-domains": {
                "type": "object"
            },
            "top-clients": {
                "type": "object"
            },
            "top-rcodes": {
                "type": "object"
            },
            "top-rrtypes": {
                "type": "object"
            }
          }
        },
        "CountersResponse": {
          "type": "object",
          "properties": {
            "stream": {
              "type": "string"
            },
            "counters": {
              "$ref": "#/definitions/Counters"
            }
          }
        },
        "Counters": {
            "type": "object",
            "properties": {
              "clients": {
                  "type": "int64"
              },
              "domains": {
                  "type": "int64"
              },
              "qps": {
                  "type": "int64"
              },
              "query": {
                  "type": "int64"
              },
              "response": {
                  "type": "int64"
              },
              "response/[rcode]": {
                  "type": "int64"
              }
            }
        },
        "Stream": {
            "type": "object",
            "properties": {
              "identity": {
                  "type": "string"
              }
            }
        }
    }
}