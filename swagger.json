{
    "swagger": "2.0",
    "info": {
        "description": "This is a swagger for the API of the dnstap receiver.",
        "version": "2.2.0",
        "title": "Swagger for dnstap receiver",
        "contact": {
          "email": "d.machard@gmail.com"
        },
        "license": {
          "name": "MIT",
          "url": "https://github.com/dmachard/dnstap-receiver/blob/master/LICENSE"
        }
    },
    "host": "localhost",
    "basePath": "/",
    "schemes": [
        "http"
    ],
    "tags": [
        {
          "name": "statistics",
          "description": ""
        },
        {
          "name": "streams",
          "description": ""
        }
    ],
    "paths": {
        "/counters": {
            "get": {
                "tags": [
                  "statistics"
                ],
                "summary": "Get counters",
                "description": "Get counters like number of clients, domains, queries, etc...",
                "operationId": "getCounters",
                "produces": [
                  "application/json"
                ],
                "parameters": [
                ],
                "responses": {
                  "200": {
                    "description": "",
                     "schema": {
                          "$ref": "#/definitions/CountersResponse"
                     }
                  }
                }
            }
        },
        "/tables": {
            "get": {
                "tags": [
                  "statistics"
                ],
                "summary": "Get tables",
                "description": "Get tables like top domains, top clients, etc...",
                "operationId": "getTables",
                "produces": [
                  "application/json"
                ],
                "parameters": [
                ],
                "responses": {
                  "200": {
                    "description": "",
                     "schema": {
                          "$ref": "#/definitions/TablesResponse"
                        }
                  }
                }
            }
        },

        "/streams": {
            "get": {
                "tags": [
                  "streams"
                ],
                "summary": "Get streams list",
                "description": "Get a list of all streams by identity received by the dnstap receiver",
                "operationId": "getStreams",
                "produces": [
                  "application/json"
                ],
                "parameters": [
                ],
                "responses": {
                  "200": {
                    "description": "",
                    "schema": {
                      "type": "array",
                      "items": {
                        "$ref": "#/definitions/Stream"
                      }
                    }
                  }
            }
          }  
        },
        "/reset": {
            "delete": {
                "tags": [
                  "streams"
                ],
                "summary": "Reset statistics",
                "description": "",
                "operationId": "resetStatistics",
                "produces": [
                ],
                "parameters": [
                ],
                "responses": {
                  "204": {
                    "description": "No Content",
                  }
                }
            }
        }
    },
    "definitions": {
        "TablesResponse": {
          "type": "object",
          "properties": {
            "stream": {
              "type": "string"
          },
          "top-domains": {
              "type": "object"
          },
          "top-clients": {
                "type": "object"
           },
           "top-rcodes": {
                "type": "object"
          },
          "top-rrtypes": {
                "type": "object"
            }
          }
        },
        "CountersResponse": {
          "type": "object",
          "properties": {
            "stream": {
              "type": "string"
            },
            "counters": {
              "$ref": "#/definitions/Counters"
            }
          }
        },
        "Counters": {
            "type": "object",
            "properties": {
              "clients": {
                  "type": "integer"
              },
              "domains": {
                  "type": "integer"
              },
              "qps": {
                  "type": "integer"
              },
              "query": {
                  "type": "integer"
              },
              "response": {
                  "type": "integer"
              },
              "response/[rcode]": {
                  "type": "integer"
              }
            }
        },
        "Stream": {
            "type": "object",
            "properties": {
              "dnstap-identity": {
                  "type": "string"
              }
            }
        }
    }
}